{"remainingRequest":"/Users/admin/Desktop/luckytruck/node_modules/babel-loader/lib/index.js!/Users/admin/Desktop/luckytruck/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/admin/Desktop/luckytruck/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/admin/Desktop/luckytruck/src/views/SimpleEstimateWizard.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/admin/Desktop/luckytruck/src/views/SimpleEstimateWizard.vue","mtime":1558084536000},{"path":"/Users/admin/Desktop/luckytruck/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/luckytruck/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/admin/Desktop/luckytruck/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/luckytruck/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/Users/admin/Desktop/luckytruck/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/admin/Desktop/luckytruck/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { required, email } from 'vuelidate/lib/validators';\nimport { API } from '../api.js';\nexport default {\n  name: 'SimpleEstimateWizard',\n  components: {\n    DocumentPreviewMain: function DocumentPreviewMain() {\n      return import(\n      /* webpackChunkName: \"DocumentPreviewMain\" */\n      '../components/DocumentPreviewMain.vue');\n    },\n    DocumentPreviewDot: function DocumentPreviewDot() {\n      return import(\n      /* webpackChunkName: \"DocumentPreviewDot\" */\n      '../components/DocumentPreviewDot.vue');\n    }\n  },\n  data: function data() {\n    return {\n      formData: {\n        imageIdFront: null,\n        imageIdBack: null,\n        imageDOT: null,\n        imageRegistration: null,\n        phone: process.env.VUE_APP_WIZARD_PHONE || null,\n        email: process.env.VUE_APP_WIZARD_EMAIL || null,\n        garagingZip: process.env.VUE_APP_WIZARD_GARAGING_ZIP || null,\n        cargoType: process.env.VUE_APP_WIZARD_CARGO_TYPE || null,\n        ownerFirstName: process.env.VUE_APP_WIZARD_OWNER_FIRST_NAME || null,\n        ownerLastName: process.env.VUE_APP_WIZARD_OWNER_LAST_NAME || null,\n        ownerCountry: process.env.VUE_APP_WIZARD_OWNER_COUNTRY || null,\n        ownerState: process.env.VUE_APP_WIZARD_OWNER_STATE || null,\n        ownerCity: process.env.VUE_APP_WIZARD_OWNER_CITY || null,\n        ownerStreet: process.env.VUE_APP_WIZARD_OWNER_STREET || null,\n        ownerZip: process.env.VUE_APP_WIZARD_OWNER_ZIP || null,\n        ownerDOB: process.env.VUE_APP_WIZARD_OWNER_DOB || null,\n        yearBusinessStarted: process.env.VUE_APP_WIZARD_YEAR_BUSINESS_STARTED || null,\n        electronicDeviceProvider: process.env.VUE_APP_WIZARD_ELECTRONIC_DEVICE_PROVIDER || null,\n        currentInsuranceProvider: process.env.VUE_APP_WIZARD_CURRENT_INSURANCE_PROVIDER || null\n      },\n      mainInfo: null,\n      dotData: null,\n      getDocInfoTimeout: null,\n      resultDOT: null,\n      loading: false,\n      error: null,\n      loadingDoc: false,\n      errorDoc: null\n    };\n  },\n  // vuelidate\n  validations: {\n    formData: {\n      imageIdFront: {\n        required: required\n      },\n      imageIdBack: {\n        required: required\n      },\n      imageDOT: {\n        required: required\n      },\n      imageRegistration: {\n        required: required\n      },\n      phone: {\n        required: required\n      },\n      email: {\n        required: required,\n        email: email\n      },\n      garagingZip: {\n        required: required\n      },\n      cargoType: {\n        required: required\n      },\n      ownerFirstName: {\n        required: required\n      },\n      ownerLastName: {\n        required: required\n      },\n      ownerCountry: {\n        required: required\n      },\n      ownerState: {\n        required: required\n      },\n      ownerCity: {\n        required: required\n      },\n      ownerStreet: {\n        required: required\n      },\n      ownerZip: {\n        required: required\n      },\n      ownerDOB: {\n        required: required\n      },\n      yearBusinessStarted: {\n        required: required\n      },\n      electronicDeviceProvider: {\n        required: required\n      },\n      currentInsuranceProvider: {\n        required: required\n      }\n    }\n  },\n  computed: {\n    imgPrefix: function imgPrefix() {\n      return \"\".concat(process.env.VUE_APP_BACKEND_URL, \"/tmp/\");\n    }\n  },\n  beforeDestroy: function beforeDestroy() {\n    clearTimeout(this.getDocInfoTimeout);\n  },\n  methods: {\n    setImage: function setImage(event, fieldName) {\n      var files = event.target.files;\n\n      if (!files.length) {\n        this.$v.formData[fieldName].$model = null;\n        return;\n      }\n\n      this.$v.formData[fieldName].$model = files[0];\n    },\n    docTryAgain: function docTryAgain() {\n      if (this.resultDOT === false) {\n        this.errorDoc = null;\n        this.mainInfo = null;\n      } else {\n        this.getDocInfo();\n      }\n    },\n    submit: function () {\n      var _submit = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var data;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.$v.$touch();\n\n                if (!this.$v.$invalid) {\n                  _context.next = 4;\n                  break;\n                }\n\n                console.log('form invalid');\n                return _context.abrupt(\"return\");\n\n              case 4:\n                console.log('submit');\n                _context.prev = 5;\n                this.error = null;\n                this.loading = true;\n                _context.next = 10;\n                return API.formData('documents/upload', _objectSpread({}, this.formData));\n\n              case 10:\n                data = _context.sent;\n                console.log(data);\n\n                if (data.status === 'OK') {\n                  this.mainInfo = data.data;\n                  this.getDocInfo();\n                }\n\n                _context.next = 18;\n                break;\n\n              case 15:\n                _context.prev = 15;\n                _context.t0 = _context[\"catch\"](5);\n                this.error = _context.t0.message;\n\n              case 18:\n                _context.prev = 18;\n                this.loading = false;\n                return _context.finish(18);\n\n              case 21:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[5, 15, 18, 21]]);\n      }));\n\n      function submit() {\n        return _submit.apply(this, arguments);\n      }\n\n      return submit;\n    }(),\n    getDocInfo: function () {\n      var _getDocInfo = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var data;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                console.log('getDocInfo');\n                this.loadingDoc = true;\n                this.errorDoc = null;\n                _context2.prev = 3;\n                _context2.next = 6;\n                return API.post('documents/admin/item', {\n                  _id: this.mainInfo._id\n                });\n\n              case 6:\n                data = _context2.sent;\n                console.log(data);\n\n                if (!(data.status === 'OK')) {\n                  _context2.next = 15;\n                  break;\n                }\n\n                if (!(data.data.resultDOT === false || data.data.resultDOT === 'false')) {\n                  _context2.next = 14;\n                  break;\n                }\n\n                this.loadingDoc = false;\n                this.resultDOT = false;\n                this.errorDoc = 'Could not parse DOT document.';\n                return _context2.abrupt(\"return\");\n\n              case 14:\n                if (data.data.resultDOTSaferData) {\n                  console.log('done');\n                  this.loadingDoc = false;\n                  this.dotData = data.data.resultDOTSaferData;\n                } else {\n                  console.log('no DOT data');\n                  this.getDocInfoTimeout = setTimeout(this.getDocInfo, 1000);\n                }\n\n              case 15:\n                _context2.next = 21;\n                break;\n\n              case 17:\n                _context2.prev = 17;\n                _context2.t0 = _context2[\"catch\"](3);\n                this.errorDoc = _context2.t0.message;\n                this.loadingDoc = false;\n\n              case 21:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[3, 17]]);\n      }));\n\n      function getDocInfo() {\n        return _getDocInfo.apply(this, arguments);\n      }\n\n      return getDocInfo;\n    }()\n  }\n};",{"version":3,"sources":["SimpleEstimateWizard.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"simple-estimate-wizard container\">\n    <h1 class=\"h2\">Simple Estimate Wizard</h1>\n\n    <div v-if=\"!mainInfo\" class=\"row justify-content-center\">\n      <div class=\"col-12 col-sm-8 col-md-6 col-lg-5\">\n        <form @submit.prevent=\"submit\">\n          <!-- imageIdFront -->\n          <div class=\"form-group\">\n            <label\n              :class=\"{ 'has-error': $v.formData.imageIdFront.$error }\"\n              for=\"imageIdFront\"\n              class=\"lt-input\"\n            >\n              Select Image ID Front*\n            </label>\n\n            <input\n              id=\"imageIdFront\"\n              type=\"file\"\n              hidden\n              @change=\"setImage($event, 'imageIdFront')\"\n            />\n\n            <div v-if=\"$v.formData.imageIdFront.$model\" class=\"text-muted\">\n              {{ $v.formData.imageIdFront.$model.name }}\n            </div>\n\n            <div v-if=\"$v.formData.imageIdFront.$error\" class=\"text-danger\">\n              File is required\n            </div>\n          </div>\n\n          <!-- imageIdBack -->\n          <div class=\"form-group\">\n            <label\n              :class=\"{ 'has-error': $v.formData.imageIdBack.$error }\"\n              for=\"imageIdBack\"\n              class=\"lt-input\"\n            >\n              Select Image ID Back*\n            </label>\n\n            <input\n              id=\"imageIdBack\"\n              type=\"file\"\n              hidden\n              @change=\"setImage($event, 'imageIdBack')\"\n            />\n\n            <div v-if=\"$v.formData.imageIdBack.$model\" class=\"text-muted\">\n              {{ $v.formData.imageIdBack.$model.name }}\n            </div>\n\n            <div v-if=\"$v.formData.imageIdBack.$error\" class=\"text-danger\">\n              File is required\n            </div>\n          </div>\n\n          <!-- imageDOT -->\n          <div class=\"form-group\">\n            <label\n              :class=\"{ 'has-error': $v.formData.imageDOT.$error }\"\n              for=\"imageDOT\"\n              class=\"lt-input\"\n            >\n              Select Image DOT*\n            </label>\n\n            <input\n              id=\"imageDOT\"\n              type=\"file\"\n              hidden\n              @change=\"setImage($event, 'imageDOT')\"\n            />\n\n            <div v-if=\"$v.formData.imageDOT.$model\" class=\"text-muted\">\n              {{ $v.formData.imageDOT.$model.name }}\n            </div>\n\n            <div v-if=\"$v.formData.imageDOT.$error\" class=\"text-danger\">\n              File is required\n            </div>\n          </div>\n\n          <!-- imageRegistration -->\n          <div class=\"form-group\">\n            <label\n              :class=\"{ 'has-error': $v.formData.imageRegistration.$error }\"\n              for=\"imageRegistration\"\n              class=\"lt-input\"\n            >\n              Select Image Registration*\n            </label>\n\n            <input\n              id=\"imageRegistration\"\n              type=\"file\"\n              hidden\n              @change=\"setImage($event, 'imageRegistration')\"\n            />\n\n            <div v-if=\"$v.formData.imageRegistration.$model\" class=\"text-muted\">\n              {{ $v.formData.imageRegistration.$model.name }}\n            </div>\n\n            <div\n              v-if=\"$v.formData.imageRegistration.$error\"\n              class=\"text-danger\"\n            >\n              File is required\n            </div>\n          </div>\n\n          <!-- phone -->\n          <div class=\"form-group\">\n            <input\n              v-model=\"$v.formData.phone.$model\"\n              :class=\"{ 'has-error': $v.formData.phone.$error }\"\n              type=\"tel\"\n              class=\"lt-input\"\n              placeholder=\"Phone Number*\"\n            />\n\n            <div v-if=\"$v.formData.phone.$error\" class=\"text-danger\">\n              Field is required\n            </div>\n          </div>\n\n          <!-- email -->\n          <div class=\"form-group\">\n            <input\n              v-model.lazy=\"$v.formData.email.$model\"\n              :class=\"{ 'has-error': $v.formData.email.$error }\"\n              type=\"email\"\n              class=\"lt-input\"\n              placeholder=\"Email*\"\n            />\n\n            <div\n              v-if=\"$v.formData.email.$error && !$v.formData.email.required\"\n              class=\"text-danger\"\n            >\n              Field is required\n            </div>\n\n            <div\n              v-if=\"$v.formData.email.$error && !$v.formData.email.email\"\n              class=\"text-danger\"\n            >\n              Invalid email\n            </div>\n          </div>\n\n          <!-- garagingZip -->\n          <div class=\"form-group\">\n            <input\n              v-model=\"$v.formData.garagingZip.$model\"\n              :class=\"{ 'has-error': $v.formData.garagingZip.$error }\"\n              type=\"text\"\n              class=\"lt-input\"\n              placeholder=\"Garaging Zip*\"\n            />\n\n            <div v-if=\"$v.formData.garagingZip.$error\" class=\"text-danger\">\n              Field is required\n            </div>\n          </div>\n\n          <!-- cargoType -->\n          <div class=\"form-group\">\n            <input\n              v-model=\"$v.formData.cargoType.$model\"\n              :class=\"{ 'has-error': $v.formData.cargoType.$error }\"\n              type=\"text\"\n              class=\"lt-input\"\n              placeholder=\"Cargo Type*\"\n            />\n\n            <div v-if=\"$v.formData.cargoType.$error\" class=\"text-danger\">\n              Field is required\n            </div>\n          </div>\n\n          <!-- ownerFirstName -->\n          <div class=\"form-group\">\n            <input\n              v-model=\"$v.formData.ownerFirstName.$model\"\n              :class=\"{ 'has-error': $v.formData.ownerFirstName.$error }\"\n              type=\"text\"\n              class=\"lt-input\"\n              placeholder=\"Owner First Name*\"\n            />\n\n            <div v-if=\"$v.formData.ownerFirstName.$error\" class=\"text-danger\">\n              Field is required\n            </div>\n          </div>\n\n          <!-- ownerLastName -->\n          <div class=\"form-group\">\n            <input\n              v-model=\"$v.formData.ownerLastName.$model\"\n              :class=\"{ 'has-error': $v.formData.ownerLastName.$error }\"\n              type=\"text\"\n              class=\"lt-input\"\n              placeholder=\"Owner Last Name*\"\n            />\n\n            <div v-if=\"$v.formData.ownerLastName.$error\" class=\"text-danger\">\n              Field is required\n            </div>\n          </div>\n\n          <!-- ownerCountry -->\n          <div class=\"form-group\">\n            <input\n              v-model=\"$v.formData.ownerCountry.$model\"\n              :class=\"{ 'has-error': $v.formData.ownerCountry.$error }\"\n              type=\"text\"\n              class=\"lt-input\"\n              placeholder=\"Owner Address*\"\n            />\n\n            <div v-if=\"$v.formData.ownerCountry.$error\" class=\"text-danger\">\n              Field is required\n            </div>\n          </div>\n\n          <!-- ownerState -->\n          <div class=\"form-group\">\n            <input\n              v-model=\"$v.formData.ownerState.$model\"\n              :class=\"{ 'has-error': $v.formData.ownerState.$error }\"\n              type=\"text\"\n              class=\"lt-input\"\n              placeholder=\"Owner State*\"\n            />\n\n            <div v-if=\"$v.formData.ownerState.$error\" class=\"text-danger\">\n              Field is required\n            </div>\n          </div>\n\n          <!-- ownerCity -->\n          <div class=\"form-group\">\n            <input\n              v-model=\"$v.formData.ownerCity.$model\"\n              :class=\"{ 'has-error': $v.formData.ownerCity.$error }\"\n              type=\"text\"\n              class=\"lt-input\"\n              placeholder=\"Owner City*\"\n            />\n\n            <div v-if=\"$v.formData.ownerCity.$error\" class=\"text-danger\">\n              Field is required\n            </div>\n          </div>\n\n          <!-- ownerStreet -->\n          <div class=\"form-group\">\n            <input\n              v-model=\"$v.formData.ownerStreet.$model\"\n              :class=\"{ 'has-error': $v.formData.ownerStreet.$error }\"\n              type=\"text\"\n              class=\"lt-input\"\n              placeholder=\"Owner Street*\"\n            />\n\n            <div v-if=\"$v.formData.ownerStreet.$error\" class=\"text-danger\">\n              Field is required\n            </div>\n          </div>\n\n          <!-- ownerZip -->\n          <div class=\"form-group\">\n            <input\n              v-model=\"$v.formData.ownerZip.$model\"\n              :class=\"{ 'has-error': $v.formData.ownerZip.$error }\"\n              type=\"text\"\n              class=\"lt-input\"\n              placeholder=\"Owner ZIP*\"\n            />\n\n            <div v-if=\"$v.formData.ownerZip.$error\" class=\"text-danger\">\n              Field is required\n            </div>\n          </div>\n\n          <!-- ownerDOB -->\n          <div class=\"form-group\">\n            <input\n              v-model=\"$v.formData.ownerDOB.$model\"\n              :class=\"{ 'has-error': $v.formData.ownerDOB.$error }\"\n              type=\"text\"\n              class=\"lt-input\"\n              placeholder=\"Owner Date of Birthday*\"\n            />\n\n            <div v-if=\"$v.formData.ownerDOB.$error\" class=\"text-danger\">\n              Field is required\n            </div>\n          </div>\n\n          <!-- yearBusinessStarted -->\n          <div class=\"form-group\">\n            <input\n              v-model=\"$v.formData.yearBusinessStarted.$model\"\n              :class=\"{ 'has-error': $v.formData.yearBusinessStarted.$error }\"\n              type=\"text\"\n              class=\"lt-input\"\n              placeholder=\"Year Business Started*\"\n            />\n\n            <div\n              v-if=\"$v.formData.yearBusinessStarted.$error\"\n              class=\"text-danger\"\n            >\n              Field is required\n            </div>\n          </div>\n\n          <!-- electronicDeviceProvider -->\n          <div class=\"form-group\">\n            <input\n              v-model=\"$v.formData.electronicDeviceProvider.$model\"\n              :class=\"{\n                'has-error': $v.formData.electronicDeviceProvider.$error\n              }\"\n              type=\"text\"\n              class=\"lt-input\"\n              placeholder=\"Electronic Device Provider*\"\n            />\n\n            <div\n              v-if=\"$v.formData.electronicDeviceProvider.$error\"\n              class=\"text-danger\"\n            >\n              Field is required\n            </div>\n          </div>\n\n          <!-- currentInsuranceProvider -->\n          <div class=\"form-group\">\n            <input\n              v-model=\"$v.formData.currentInsuranceProvider.$model\"\n              :class=\"{\n                'has-error': $v.formData.currentInsuranceProvider.$error\n              }\"\n              type=\"text\"\n              class=\"lt-input\"\n              placeholder=\"Current Insurance Provider*\"\n            />\n\n            <div\n              v-if=\"$v.formData.currentInsuranceProvider.$error\"\n              class=\"text-danger\"\n            >\n              Field is required\n            </div>\n          </div>\n\n          <div v-if=\"error\" class=\"form-group\">\n            <div class=\"alert alert-danger\" role=\"alert\">\n              {{ error }}\n            </div>\n          </div>\n\n          <!-- submit -->\n          <div class=\"text-center\">\n            <button\n              :disabled=\"loading\"\n              type=\"submit\"\n              class=\"lt-button lt-button-main\"\n            >\n              {{ loading ? 'Loading...' : 'Submit' }}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n\n    <document-preview-main v-if=\"mainInfo\" :document=\"mainInfo\" />\n\n    <div v-if=\"loadingDoc\">\n      <h3>Processing...</h3>\n    </div>\n\n    <div v-if=\"errorDoc\" class=\"form-group my-2\">\n      <div class=\"alert alert-danger\" role=\"alert\">\n        <div>{{ errorDoc }}</div>\n        <div class=\"text-center\">\n          <button class=\"btn btn-light\" @click=\"docTryAgain\">Try Again</button>\n        </div>\n      </div>\n    </div>\n\n    <document-preview-dot v-if=\"dotData\" :dot-data=\"dotData\" />\n  </div>\n</template>\n\n<script>\nimport { required, email } from 'vuelidate/lib/validators';\nimport { API } from '../api.js';\n\nexport default {\n  name: 'SimpleEstimateWizard',\n  components: {\n    DocumentPreviewMain: () =>\n      import(/* webpackChunkName: \"DocumentPreviewMain\" */\n      '../components/DocumentPreviewMain.vue'),\n    DocumentPreviewDot: () =>\n      import(/* webpackChunkName: \"DocumentPreviewDot\" */\n      '../components/DocumentPreviewDot.vue')\n  },\n  data() {\n    return {\n      formData: {\n        imageIdFront: null,\n        imageIdBack: null,\n        imageDOT: null,\n        imageRegistration: null,\n        phone: process.env.VUE_APP_WIZARD_PHONE || null,\n        email: process.env.VUE_APP_WIZARD_EMAIL || null,\n        garagingZip: process.env.VUE_APP_WIZARD_GARAGING_ZIP || null,\n        cargoType: process.env.VUE_APP_WIZARD_CARGO_TYPE || null,\n        ownerFirstName: process.env.VUE_APP_WIZARD_OWNER_FIRST_NAME || null,\n        ownerLastName: process.env.VUE_APP_WIZARD_OWNER_LAST_NAME || null,\n        ownerCountry: process.env.VUE_APP_WIZARD_OWNER_COUNTRY || null,\n        ownerState: process.env.VUE_APP_WIZARD_OWNER_STATE || null,\n        ownerCity: process.env.VUE_APP_WIZARD_OWNER_CITY || null,\n        ownerStreet: process.env.VUE_APP_WIZARD_OWNER_STREET || null,\n        ownerZip: process.env.VUE_APP_WIZARD_OWNER_ZIP || null,\n        ownerDOB: process.env.VUE_APP_WIZARD_OWNER_DOB || null,\n        yearBusinessStarted:\n          process.env.VUE_APP_WIZARD_YEAR_BUSINESS_STARTED || null,\n        electronicDeviceProvider:\n          process.env.VUE_APP_WIZARD_ELECTRONIC_DEVICE_PROVIDER || null,\n        currentInsuranceProvider:\n          process.env.VUE_APP_WIZARD_CURRENT_INSURANCE_PROVIDER || null\n      },\n      mainInfo: null,\n      dotData: null,\n      getDocInfoTimeout: null,\n      resultDOT: null,\n      loading: false,\n      error: null,\n      loadingDoc: false,\n      errorDoc: null\n    };\n  },\n  // vuelidate\n  validations: {\n    formData: {\n      imageIdFront: { required },\n      imageIdBack: { required },\n      imageDOT: { required },\n      imageRegistration: { required },\n      phone: { required },\n      email: { required, email },\n      garagingZip: { required },\n      cargoType: { required },\n      ownerFirstName: { required },\n      ownerLastName: { required },\n      ownerCountry: { required },\n      ownerState: { required },\n      ownerCity: { required },\n      ownerStreet: { required },\n      ownerZip: { required },\n      ownerDOB: { required },\n      yearBusinessStarted: { required },\n      electronicDeviceProvider: { required },\n      currentInsuranceProvider: { required }\n    }\n  },\n  computed: {\n    imgPrefix() {\n      return `${process.env.VUE_APP_BACKEND_URL}/tmp/`;\n    }\n  },\n  beforeDestroy() {\n    clearTimeout(this.getDocInfoTimeout);\n  },\n  methods: {\n    setImage(event, fieldName) {\n      let { files } = event.target;\n\n      if (!files.length) {\n        this.$v.formData[fieldName].$model = null;\n        return;\n      }\n\n      this.$v.formData[fieldName].$model = files[0];\n    },\n    docTryAgain() {\n      if (this.resultDOT === false) {\n        this.errorDoc = null;\n        this.mainInfo = null;\n      } else {\n        this.getDocInfo();\n      }\n    },\n    async submit() {\n      this.$v.$touch();\n\n      if (this.$v.$invalid) {\n        console.log('form invalid');\n        return;\n      }\n\n      console.log('submit');\n\n      try {\n        this.error = null;\n        this.loading = true;\n\n        let data = await API.formData('documents/upload', {\n          ...this.formData\n        });\n\n        console.log(data);\n        if (data.status === 'OK') {\n          this.mainInfo = data.data;\n          this.getDocInfo();\n        }\n      } catch (error) {\n        this.error = error.message;\n      } finally {\n        this.loading = false;\n      }\n    },\n    async getDocInfo() {\n      console.log('getDocInfo');\n      this.loadingDoc = true;\n      this.errorDoc = null;\n\n      try {\n        let data = await API.post('documents/admin/item', {\n          _id: this.mainInfo._id\n        });\n\n        console.log(data);\n        if (data.status === 'OK') {\n          if (\n            data.data.resultDOT === false ||\n            data.data.resultDOT === 'false'\n          ) {\n            this.loadingDoc = false;\n            this.resultDOT = false;\n            this.errorDoc = 'Could not parse DOT document.';\n            return;\n          }\n\n          if (data.data.resultDOTSaferData) {\n            console.log('done');\n            this.loadingDoc = false;\n            this.dotData = data.data.resultDOTSaferData;\n          } else {\n            console.log('no DOT data');\n            this.getDocInfoTimeout = setTimeout(this.getDocInfo, 1000);\n          }\n        }\n      } catch (error) {\n        this.errorDoc = error.message;\n        this.loadingDoc = false;\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n// div {\n//   outline: 1px solid red;\n// }\n\n// test\n</style>\n"],"sourceRoot":"src/views"}]}